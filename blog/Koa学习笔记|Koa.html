<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Koa 笔记 | 大前端研究所</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/frontend/favicon.ico">
    <meta name="description" content="欢迎关注公众号：大前端研究所">
    
    <link rel="preload" href="/frontend/assets/css/0.styles.7c5de612.css" as="style"><link rel="preload" href="/frontend/assets/js/app.81e51045.js" as="script"><link rel="preload" href="/frontend/assets/js/2.b2951490.js" as="script"><link rel="preload" href="/frontend/assets/js/9.ba78b3d4.js" as="script"><link rel="prefetch" href="/frontend/assets/js/10.6942882c.js"><link rel="prefetch" href="/frontend/assets/js/11.8cf1fb5d.js"><link rel="prefetch" href="/frontend/assets/js/12.dd903ed4.js"><link rel="prefetch" href="/frontend/assets/js/13.d2b10253.js"><link rel="prefetch" href="/frontend/assets/js/14.59046f73.js"><link rel="prefetch" href="/frontend/assets/js/15.08f63d2d.js"><link rel="prefetch" href="/frontend/assets/js/16.10da3fa2.js"><link rel="prefetch" href="/frontend/assets/js/3.66d53e08.js"><link rel="prefetch" href="/frontend/assets/js/4.60aa8e5e.js"><link rel="prefetch" href="/frontend/assets/js/5.3075a5b6.js"><link rel="prefetch" href="/frontend/assets/js/6.2cb66473.js"><link rel="prefetch" href="/frontend/assets/js/7.61c88007.js"><link rel="prefetch" href="/frontend/assets/js/8.87b399e5.js">
    <link rel="stylesheet" href="/frontend/assets/css/0.styles.7c5de612.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/frontend/" class="home-link router-link-active"><!----> <span class="site-name">大前端研究所</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/frontend/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/frontend/share/" class="nav-link">
  分享
</a></div><div class="nav-item"><a href="/frontend/interview/" class="nav-link">
  面试
</a></div> <a href="https://github.com/alfalfaw/frontend" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/frontend/blog/" class="nav-link router-link-active">
  博客
</a></div><div class="nav-item"><a href="/frontend/share/" class="nav-link">
  分享
</a></div><div class="nav-item"><a href="/frontend/interview/" class="nav-link">
  面试
</a></div> <a href="https://github.com/alfalfaw/frontend" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Express</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/blog/" aria-current="page" class="sidebar-link">简介</a></li><li><a href="/frontend/blog/Express学习笔记|Express.html" class="sidebar-link">Express 笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Koa</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/blog/Koa学习笔记|Koa.html" class="active sidebar-link">Koa 笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#restful-api" class="sidebar-link">RESTful API</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#koa-请求参数" class="sidebar-link">Koa 请求参数</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#koa-发送响应" class="sidebar-link">Koa 发送响应</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#编写控制器最佳实践" class="sidebar-link">编写控制器最佳实践</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#目录结构" class="sidebar-link">目录结构</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#koa-高级" class="sidebar-link">Koa 高级</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#权限认证" class="sidebar-link">权限认证</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#上传图片" class="sidebar-link">上传图片</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#分页和模糊搜索" class="sidebar-link">分页和模糊搜索</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#功能列表" class="sidebar-link">功能列表</a></li><li class="sidebar-sub-header"><a href="/frontend/blog/Koa学习笔记|Koa.html#api-文档" class="sidebar-link">API 文档</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/blog/VuePress部署到GithubPages|前端.html" class="sidebar-link">VuePress 搭建个人博客网站</a></li><li><a href="/frontend/blog/vee-validate基本用法|前端.html" class="sidebar-link">vee-validate 基本用法</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="koa-笔记"><a href="#koa-笔记" class="header-anchor">#</a> Koa 笔记</h1> <h2 id="restful-api"><a href="#restful-api" class="header-anchor">#</a> RESTful API</h2> <h3 id="请求规范"><a href="#请求规范" class="header-anchor">#</a> 请求规范</h3> <ul><li><p>URI 使用名词，尽量使用复数，如<code>/users</code></p></li> <li><p>URI 使用嵌套表示关联关系 如<code>/users/12/repos/5</code></p></li> <li><p>使用正确的 HTTP 方法，如 GET、POST、PUT、DELETE</p></li></ul> <h3 id="响应规范"><a href="#响应规范" class="header-anchor">#</a> 响应规范</h3> <ul><li>查询</li> <li>状态码</li> <li>分页</li> <li>字段过滤</li> <li>错误处理</li></ul> <h3 id="安全"><a href="#安全" class="header-anchor">#</a> 安全</h3> <ul><li>HTTPS</li> <li>鉴权</li> <li>限流</li></ul> <h3 id="curd"><a href="#curd" class="header-anchor">#</a> CURD</h3> <ul><li><p>GET 返回 200</p></li> <li><p>POST 返回新建对象，PATCH 更新部分属性，返回修改对象</p></li> <li><p>PUT 返回修改对象</p></li> <li><p>DELETE 返回 204</p></li></ul> <h3 id="断点调试"><a href="#断点调试" class="header-anchor">#</a> 断点调试</h3> <p>先打上断点，然后按 fn + f5 运行项目</p> <p><a href="https://imgchr.com/i/w8g441" target="_blank" rel="noopener noreferrer"><img src="https://upload-images.jianshu.io/upload_images/20823417-a614808da8c2eb77.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="w8g441.png"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>对于常用的变量可以<code>add to watch</code>方便以后查找</p> <h2 id="koa-请求参数"><a href="#koa-请求参数" class="header-anchor">#</a> Koa 请求参数</h2> <p>Koa 获取参数有两种方式，一种是从上下文对象中直接获取，另一种是从上下文的 request 对象中获取。请求参数主要包含以下内容</p> <ul><li>Query String，如 q=100</li></ul> <p>从上下文中获取 query 参数</p> <p>获取请求对象 <code>ctx.query</code>返回<code>{q: 100}</code></p> <p>获取请求字符串 <code>ctx.querystring</code>返回<code>q=100</code></p> <p>从上下文的<code>request</code>对象中获取参数</p> <p>获取请求对象 <code>ctx.request.query</code>返回<code>{q: 100}</code></p> <p>获取请求字符串 <code>ctx.request.querystring</code>返回<code>{q: 100}</code></p> <ul><li>Router Params，如/user/:id</li></ul> <p>获取路由中的参数<code>ctx.request.params.id</code></p> <ul><li>Body</li></ul> <p>获取请求体可以借助第三方中间件来，如<code>koa-body</code>或者<code>koa-bodyparser</code>，使用过程可以参考<a href="http://www.ptbird.cn/koa-body.html" target="_blank" rel="noopener noreferrer">这篇文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>Header, 如 Accept、Cookie</li></ul> <p>获取请求头可以通过<code>ctx.request.headers</code></p> <h2 id="koa-发送响应"><a href="#koa-发送响应" class="header-anchor">#</a> Koa 发送响应</h2> <h3 id="status"><a href="#status" class="header-anchor">#</a> status</h3> <p>设置响应状态码使用<code>ctx.response.status = 200</code>，如果状态码没有被设置，那么 koa 会自动设置为<code>200</code>或<code>204</code></p> <p>各种场景对应的状态码如下</p> <div class="language- extra-class"><pre class="language-text"><code>100 &quot;continue&quot;
101 &quot;switching protocols&quot;
102 &quot;processing&quot;
200 &quot;ok&quot;
201 &quot;created&quot;
202 &quot;accepted&quot;
203 &quot;non-authoritative information&quot;
204 &quot;no content&quot;
205 &quot;reset content&quot;
206 &quot;partial content&quot;
207 &quot;multi-status&quot;
208 &quot;already reported&quot;
226 &quot;im used&quot;
300 &quot;multiple choices&quot;
301 &quot;moved permanently&quot;
302 &quot;found&quot;
303 &quot;see other&quot;
304 &quot;not modified&quot;
305 &quot;use proxy&quot;
307 &quot;temporary redirect&quot;
308 &quot;permanent redirect&quot;
400 &quot;bad request&quot;
401 &quot;unauthorized&quot;
402 &quot;payment required&quot;
403 &quot;forbidden&quot;
404 &quot;not found&quot;
405 &quot;method not allowed&quot;
406 &quot;not acceptable&quot;
407 &quot;proxy authentication required&quot;
408 &quot;request timeout&quot;
409 &quot;conflict&quot;
410 &quot;gone&quot;
411 &quot;length required&quot;
412 &quot;precondition failed&quot;
413 &quot;payload too large&quot;
414 &quot;uri too long&quot;
415 &quot;unsupported media type&quot;
416 &quot;range not satisfiable&quot;
417 &quot;expectation failed&quot;
418 &quot;I'm a teapot&quot;
422 &quot;unprocessable entity&quot;
423 &quot;locked&quot;
424 &quot;failed dependency&quot;
426 &quot;upgrade required&quot;
428 &quot;precondition required&quot;
429 &quot;too many requests&quot;
431 &quot;request header fields too large&quot;
500 &quot;internal server error&quot;
501 &quot;not implemented&quot;
502 &quot;bad gateway&quot;
503 &quot;service unavailable&quot;
504 &quot;gateway timeout&quot;
505 &quot;http version not supported&quot;
506 &quot;variant also negotiates&quot;
507 &quot;insufficient storage&quot;
508 &quot;loop detected&quot;
510 &quot;not extended&quot;
511 &quot;network authentication required&quot;
</code></pre></div><h3 id="message"><a href="#message" class="header-anchor">#</a> message</h3> <p>响应状态消息一般和状态码有关，设置方式是<code>ctx.response.message = 'something was wrong.'</code></p> <h3 id="body"><a href="#body" class="header-anchor">#</a> body</h3> <p><code>ctx.response.body = {}</code>，其中响应体可以是以下类型</p> <ul><li>String 类型</li> <li>Buffer 流</li> <li>Stream 管道</li> <li>Object || Array JSON</li> <li>null 无内容</li></ul> <table><thead><tr><th>Body 类型</th> <th>Content-Type</th></tr></thead> <tbody><tr><td>String</td> <td>text/html 或 text/plain</td></tr> <tr><td>Buffer</td> <td>application/octet-stream</td></tr> <tr><td>Stream</td> <td>application/octet-stream</td></tr> <tr><td>Object || Array</td> <td>application/json</td></tr></tbody></table> <h3 id="header"><a href="#header" class="header-anchor">#</a> header</h3> <p>用<code>set</code>设置响应头，也可以使用<code>.</code>语法</p> <div class="language- extra-class"><pre class="language-text"><code>ctx.set({
  'Etag': '1234',
  'Last-Modified': date
});
</code></pre></div><p>设置响应的<code>Content-Type</code></p> <div class="language- extra-class"><pre class="language-text"><code>ctx.type = 'text/plain; charset=utf-8';
ctx.type = 'image/png';
ctx.type = '.png';
ctx.type = 'png';
</code></pre></div><h2 id="编写控制器最佳实践"><a href="#编写控制器最佳实践" class="header-anchor">#</a> 编写控制器最佳实践</h2> <p>处理请求、处理业务、返回响应</p> <ul><li><p>每个资源的控制器放在不同的文件里</p></li> <li><p>尽量使用类+类方法的形式编写控制器</p></li> <li><p>严谨的错误处理</p></li></ul> <h2 id="目录结构"><a href="#目录结构" class="header-anchor">#</a> 目录结构</h2> <ul><li>按照功能模块进行区分</li> <li>路由压缩 koa-combine-routers</li> <li>静态资源 koa-static</li></ul> <div class="language- extra-class"><pre class="language-text"><code>.
|____LICENSE
|____README.md
|____.gitignore
|____package-lock.json
|____package.json
|____src
| |____middlewares
| | |____check.js
| |____models
| | |____Question.js
| | |____User.js
| | |____Answer.js
| | |____Comment.js
| | |____Topic.js
| |____config.js
| |____public
| | |____index.html
| | |____uploads
| | | |____.gitkeep
| |____controllers
| | |____questions.js
| | |____users.js
| | |____comments.js
| | |____common.js
| | |____topics.js
| | |____answers.js
| |____routes
| | |____questions.js
| | |____users.js
| | |____index.js
| | |____comments.js
| | |____common.js
| | |____topics.js
| | |____answers.js
| |____app.js
</code></pre></div><h2 id="koa-高级"><a href="#koa-高级" class="header-anchor">#</a> Koa 高级</h2> <h3 id="中间件"><a href="#中间件" class="header-anchor">#</a> 中间件</h3> <div class="language- extra-class"><pre class="language-text"><code>const Koa = require('koa')
const app = new Koa()
const KoaRouter = require('koa-router')
const router = new KoaRouter()

const middleware1 = async function (ctx, next) {
  await next()
  console.log('this is middleware1')
}
const middleware2 = async function (ctx, next) {
  console.log('this is middleware2')
  await next()
}
const middleware3 = async function (ctx, next) {
  console.log('this is middleware3')
  await next()
}
router.get('/', middleware1, middleware2, middleware3, (ctx) =&gt; {
  ctx.body = 'ok'
})

app.use(router.routes()).use(router.allowedMethods())

app.listen(5000)
</code></pre></div><p>按<code>middleware</code>出现次序依次执行，遇到<code>next()</code>直接执行下一个中间件，执行完成后返回到之前代码继续执行</p> <h3 id="异常处理"><a href="#异常处理" class="header-anchor">#</a> 异常处理</h3> <p>常见错误类型</p> <ul><li>运行时错误，500</li> <li>逻辑错误，找不到<code>404</code>、先决条件失败<code>412</code>，如缺少参数，无法处理实体<code>422</code>，如参数格式不对</li></ul> <p>为什么要有错误信息</p> <ul><li><p>防止程序挂掉</p></li> <li><p>告诉用户错误信息</p></li> <li><p>便于开发调试</p></li></ul> <h4 id="koa-自带错误处理"><a href="#koa-自带错误处理" class="header-anchor">#</a> koa 自带错误处理</h4> <p>koa 会自动处理类似 404，500 等错误，并返回错误信息</p> <h4 id="自定义中间件处理错误"><a href="#自定义中间件处理错误" class="header-anchor">#</a> 自定义中间件处理错误</h4> <div class="language- extra-class"><pre class="language-text"><code>// 支持捕获主动抛出错误和运行时错误，不能捕获 404
app.use(async (ctx, next) =&gt; {
  try {
    // 如果 next 的代码出错，会被 catch 捕获
    await next();
  } catch (error) {
    ctx.status = error.status || error.statusCode || 500;
    ctx.body = {
      message: error.message,
    };
  }
});
</code></pre></div><h4 id="koa-json-error-处理错误"><a href="#koa-json-error-处理错误" class="header-anchor">#</a> koa-json-error 处理错误</h4> <p>安装</p> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-json-error
</code></pre></div><p>区分生产环境和开发环境</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;scripts&quot;: {
  &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,
  &quot;serve&quot;: &quot;nodemon src/app&quot;,
  &quot;start&quot;: &quot;NODE_ENV=production node src/app&quot;
},
</code></pre></div><p>windows 环境可能需要安装<code>cross-env</code>来配置环境变量</p> <p>配置<code>koa-json-error</code>，让其在生产环境下不打印堆栈信息</p> <div class="language- extra-class"><pre class="language-text"><code>const error = require(&quot;koa-json-error&quot;);
// 在生产环境不返回错误堆栈信息
app.use(
  error({
    postFormat: (error, { stack, ...rest }) =&gt;
      process.env.NODE_ENV === &quot;production&quot; ? rest : { stack, ...rest },
  })
);
</code></pre></div><h3 id="参数校验"><a href="#参数校验" class="header-anchor">#</a> 参数校验</h3> <p>koa-parameter 校验参数</p> <p>安装</p> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-parameter
</code></pre></div><p>使用</p> <p><strong>app.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>app.use(parameter(app));
</code></pre></div><p><strong>controllers/users.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>async create(ctx) {
  ctx.verifyParams({
    name: { type: &quot;string&quot;, required: true },
    password: { type: &quot;string&quot;, required: true },
  });
  const { name } = ctx.request.body;
  const repeatedUser = await User.findOne({ name });
  if (repeatedUser) {
    ctx.throw(409, &quot;用户名已经占用&quot;);
  }
  const user = await new User(ctx.request.body).save();

  ctx.body = user;
}
</code></pre></div><h3 id="解析请求体"><a href="#解析请求体" class="header-anchor">#</a> 解析请求体</h3> <p>安装</p> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-body
</code></pre></div><p>使用</p> <p><strong>app.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const KoaBody = require(&quot;koa-body&quot;);
// 解析 body
app.use(
  KoaBody({
    multipart: true,
    formidable: {
      uploadDir: path.join(__dirname, &quot;public/uploads&quot;),
      keepExtensions: true,
    },
  })
);
</code></pre></div><h3 id="跨域"><a href="#跨域" class="header-anchor">#</a> 跨域</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i @koa/cors
</code></pre></div><p><strong>app.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const KoaCors = require('@koa/cors')
app.use(KoaCors())
</code></pre></div><h3 id="格式化响应"><a href="#格式化响应" class="header-anchor">#</a> 格式化响应</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-json
</code></pre></div><p><strong>app.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const KoaJson = require('koa-json')
// 默认关闭 pretty , 只有当 query 参数中含有 pretty 时才会返回格式化参数
app.use(KoaJson({ pretty: false, param: 'pretty' }))
</code></pre></div><h3 id="合并路由"><a href="#合并路由" class="header-anchor">#</a> 合并路由</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-combine-routers
</code></pre></div><p><strong>app.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const Koa = require('koa')
const router = require('./routes')
const app = new Koa()
app.use(router())
</code></pre></div><p><strong>routes/index.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const Router = require('koa-router')
const combineRouters = require('koa-combine-routers')

const dogRouter = new Router()
const catRouter = new Router()

dogRouter.get('/dogs', async ctx =&gt; {
  ctx.body = 'ok'
})

catRouter.get('/cats', async ctx =&gt; {
  ctx.body = 'ok'
})

const router = combineRouters(
  dogRouter,
  catRouter
)

module.exports = router
</code></pre></div><h3 id="安全-2"><a href="#安全-2" class="header-anchor">#</a> 安全</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-helmet
</code></pre></div><p><strong>app.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const Koa = require('koa')
const KoaHelmet = require('koa-helmet')
const app = new Koa()
app.use(KoaHelmet())
</code></pre></div><h3 id="静态文件"><a href="#静态文件" class="header-anchor">#</a> 静态文件</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-static
</code></pre></div><p><strong>app.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const Koa = require('koa')
const path = require('path')
const KoaStatic = require('koa-static')
const app = new Koa()
app.use(KoaStatic(path.join(__dirname, '../public')))
</code></pre></div><h3 id="es6-webpack"><a href="#es6-webpack" class="header-anchor">#</a> es6&amp;webpack</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i -D webpack webpack-cli
npm i -D clean-webpack-plugin webpack-node-externals @babel/core @babel/node @babel/preset-env babel-loader cross-env
</code></pre></div><ul><li>clean-webpack-plugin 清理 dist 文件夹</li> <li>webpack-node-externals 排除 node_modules</li> <li>babel 支持 es6 语法</li></ul> <p><strong>webpack.config.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const path = require('path')
const nodeExternals = require('webpack-node-externals')
const { CleanWebpackPlugin } = require('clean-webpack-plugin')

const webpackconfig = {
  target: 'node',
  mode: 'development',
  entry: {
    server: path.join(__dirname, 'src/app.js')
  },
  output: {
    filename: '[name].bundle.js',
    path: path.join(__dirname, 'dist')
  },
  devtool: 'eval-source-map',
  module: {
    rules: [
      {
        test: /\.(js|jsx)$/,
        use: {
          loader: 'babel-loader'
        },
        exclude: [path.join(__dirname, 'node_modules')]
      }
    ]
  },
  externals: [nodeExternals()],
  plugins: [new CleanWebpackPlugin()],
  node: {
    console: true,
    global: true,
    process: true,
    Buffer: true,
    __filename: true,
    __dirname: true,
    setImmediate: true,
    path: true
  }
}

module.exports = webpackconfig
</code></pre></div><p><strong>.babelrc</strong></p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;presets&quot;: [
    [
      &quot;@babel/preset-env&quot;,
      {
        &quot;targets&quot;: {
          &quot;node&quot;: &quot;current&quot;
        }
      }
    ]
  ]
}
</code></pre></div><p><strong>package.json</strong></p> <div class="language- extra-class"><pre class="language-text"><code>&quot;scripts&quot;: {
  &quot;serve&quot;: &quot;nodemon --exec babel-node src/app.js&quot;
},
</code></pre></div><p>调试 webpack 配置</p> <ul><li>Chrome 调试</li></ul> <p>运行</p> <div class="language- extra-class"><pre class="language-text"><code>node --inspect-brk ./node_modules/.bin/webpack --inline --progress
</code></pre></div><p>浏览器访问<code>chrome://inspect/#devices</code>，点击<code>inspect</code>进入调试页面</p> <p>为了调试方便，可以在<code>package.json</code>文件中加入如下命令</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;scripts&quot;: {
  &quot;webpack:debug&quot;: &quot;node --inspect-brk ./node_modules/.bin/webpack --inline --progress&quot;
},
</code></pre></div><p>之后调试<code>webpack</code>只需要运行<code>npm run webpack:debug</code></p> <ul><li>VSCode 调试</li></ul> <p>在<code>configurations</code>中输入<code>nodemon</code>，选择<code>nodemon setup</code>快速生成配置样板</p> <p><strong>.vscode/launch.json</strong></p> <div class="language- extra-class"><pre class="language-text"><code>{
  // Use IntelliSense to learn about possible attributes.
  // Hover to view descriptions of existing attributes.
  // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
  &quot;version&quot;: &quot;0.2.0&quot;,
  &quot;configurations&quot;: [
    {
      &quot;console&quot;: &quot;integratedTerminal&quot;,
      &quot;internalConsoleOptions&quot;: &quot;neverOpen&quot;,
      &quot;name&quot;: &quot;nodemon&quot;,
      &quot;program&quot;: &quot;${workspaceFolder}/src/app.js&quot;,
      &quot;request&quot;: &quot;launch&quot;,
      &quot;restart&quot;: true,
      &quot;runtimeExecutable&quot;: &quot;nodemon&quot;,
      &quot;skipFiles&quot;: [&quot;&lt;node_internals&gt;/**&quot;],
      &quot;type&quot;: &quot;pwa-node&quot;,
      &quot;runtimeArgs&quot;: [&quot;--exec&quot;, &quot;babel-node&quot;]
    }
  ]
}
</code></pre></div><p><code>program</code>指定入口文件，指定<code>runtimeArgs</code>是因为使用了 es6 语法</p> <h3 id="数据库"><a href="#数据库" class="header-anchor">#</a> 数据库</h3> <h4 id="连接数据库"><a href="#连接数据库" class="header-anchor">#</a> 连接数据库</h4> <p><strong>app.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const mongoose = require(&quot;mongoose&quot;);
const { connectionStr } = require(&quot;./config&quot;);

mongoose.connect(
  connectionStr,
  { useUnifiedTopology: true, useNewUrlParser: true },
  () =&gt; console.log(&quot;connect&quot;)
);
mongoose.connection.on(&quot;error&quot;, console.error);
</code></pre></div><h4 id="定义-schema"><a href="#定义-schema" class="header-anchor">#</a> 定义 Schema</h4> <p><strong>models/User.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const mongoose = require(&quot;mongoose&quot;);

const { Schema, model } = mongoose;
const userSchema = new Schema(
  {
    name: { type: String, required: true },
    // select 为 false 时查询时默认隐藏
    password: {
      type: String,
      required: true,
      select: false,
      set(val) {
        return require(&quot;bcrypt&quot;).hashSync(val, 10);
      },
    },
    avatar_url: { type: String },
    gender: {
      type: String,
      enum: [&quot;male&quot;, &quot;female&quot;],
      default: &quot;male&quot;,
      required: true,
    },
    headline: { type: String },
    locations: {
      type: [{ type: Schema.Types.ObjectId, ref: &quot;Topic&quot; }],
      select: false,
    },
    business: { type: Schema.Types.ObjectId, ref: &quot;Topic&quot;, select: false },
    employments: {
      type: [
        {
          company: { type: Schema.Types.ObjectId, ref: &quot;Topic&quot; },
          job: { type: Schema.Types.ObjectId, ref: &quot;Topic&quot; },
        },
      ],
      select: false,
    },
    educations: {
      type: [
        {
          school: { type: Schema.Types.ObjectId, ref: &quot;Topic&quot; },
          major: { type: Schema.Types.ObjectId, ref: &quot;Topic&quot; },
          diploma: {
            type: Number,
            enum: [1, 2, 3, 4, 5],
          },
          entrance_year: { type: Number },
          graduation_year: { type: Number },
        },
      ],
      select: false,
    },
    following: {
      type: [
        {
          type: Schema.Types.ObjectId,
          ref: &quot;User&quot;,
        },
      ],
      select: false,
    },
    // 关注话题
    followingTopics: {
      type: [{ type: Schema.Types.ObjectId, ref: &quot;Topic&quot; }],
      select: false,
    },
    // 关注问题
    followingQuestions: {
      type: [{ type: Schema.Types.ObjectId, ref: &quot;Question&quot; }],
      select: false,
    },

    likingAnswers: {
      type: [
        {
          type: Schema.Types.ObjectId,
          ref: &quot;Answer&quot;,
        },
      ],
      select: false,
    },
    dislikingAnswers: {
      type: [
        {
          type: Schema.Types.ObjectId,
          ref: &quot;Answer&quot;,
        },
      ],
      select: false,
    },
    collectingAnswers: {
      type: [
        {
          type: Schema.Types.ObjectId,
          ref: &quot;Answer&quot;,
        },
      ],
      select: false,
    },
  },
  {
    timestamps: true,
  }
);

module.exports = model(&quot;User&quot;, userSchema);
</code></pre></div><h4 id="字段过滤"><a href="#字段过滤" class="header-anchor">#</a> 字段过滤</h4> <p>让一些字段默认不显示，方法是修改 schema，在默认不显示的字段上添加<code>select:false</code>。在查询时如果需要这个字段，需要加上<code>select(&quot;+fieldName&quot;)</code></p> <h2 id="权限认证"><a href="#权限认证" class="header-anchor">#</a> 权限认证</h2> <h3 id="自定义中间件完成权限认证"><a href="#自定义中间件完成权限认证" class="header-anchor">#</a> 自定义中间件完成权限认证</h3> <p><strong>controllers/users.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const jwt = require(&quot;jsonwebtoken&quot;);
const User = require(&quot;../models/User&quot;);
const { secret } = require(&quot;../config&quot;);
const bcrypt = require(&quot;bcrypt&quot;);
class UsersCtl {

  // 登录
  async login(ctx) {
    const { name, password } = ctx.request.body;
    const user = await User.findOne({ name }).select(&quot;+password&quot;);
    if (!user) {
      ctx.throw(422, &quot;用户不存在&quot;);
    }
    const isValid = bcrypt.compareSync(password, user.password);
    if (!isValid) {
      ctx.throw(422, &quot;用户密码错误&quot;);
    }

    const token = jwt.sign({ _id: user._id, name }, secret, {
      expiresIn: &quot;1d&quot;,
    });
    ctx.body = { token };
  }

  // 检查权限，只允许修改本人信息
  async checkOwner(ctx, next) {
    if (ctx.params.id !== ctx.state.user._id) {
      ctx.throw(403, &quot;没有权限&quot;);
    }
    await next();
  }
}
module.exports = new UsersCtl();
</code></pre></div><p><strong>routes/users.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const Router = require(&quot;koa-router&quot;);
const router = new Router({ prefix: &quot;/users&quot; });
const jwt = require(&quot;jsonwebtoken&quot;);
const { secret } = require(&quot;../config&quot;);
const {
  find,
  findById,
  create,
  update,
  del,
  login,
  checkOwner,
} = require(&quot;../controllers/users&quot;);

const auth = async (ctx, next) =&gt; {
  const { authorization = &quot;&quot; } = ctx.request.header;
  const token = authorization.replace(&quot;Bearer &quot;, &quot;&quot;);
  try {
    const user = jwt.verify(token, secret);
    ctx.state.user = user;
  } catch (error) {
    ctx.throw(401, error.message);
  }
  await next();
};

router.get(&quot;/&quot;, find);
router.get(&quot;/:id&quot;, findById);
router.post(&quot;/&quot;, create);
router.patch(&quot;/:id&quot;, auth, checkOwner, update);
router.delete(&quot;/:id&quot;, auth, checkOwner, del);
router.post(&quot;/login&quot;, login);

module.exports = router;
</code></pre></div><h3 id="基于-koa-jwt-实现权限认证"><a href="#基于-koa-jwt-实现权限认证" class="header-anchor">#</a> 基于 koa-jwt 实现权限认证</h3> <p>安装</p> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-jwt
</code></pre></div><p>使用</p> <div class="language- extra-class"><pre class="language-text"><code>const Router = require(&quot;koa-router&quot;);
const router = new Router({ prefix: &quot;/users&quot; });
// const jwt = require(&quot;jsonwebtoken&quot;);
const jwt = require(&quot;koa-jwt&quot;);
const { secret } = require(&quot;../config&quot;);
const {
  find,
  findById,
  create,
  update,
  del,
  login,
  checkOwner,
} = require(&quot;../controllers/users&quot;);

const auth = jwt({ secret });

// 获取用户列表
router.get(&quot;/&quot;, find);
// 获取用户详情
router.get(&quot;/:id&quot;, findById);
// 创建用户
router.post(&quot;/&quot;, create);
// 更新用户 patch 可以更新部分
router.patch(&quot;/&quot;, auth, update);
// 删除用户
router.delete(&quot;/&quot;, auth, del);
// 登录
router.post(&quot;/login&quot;, login);

module.exports = router;
</code></pre></div><h2 id="上传图片"><a href="#上传图片" class="header-anchor">#</a> 上传图片</h2> <h3 id="主要功能"><a href="#主要功能" class="header-anchor">#</a> 主要功能</h3> <p>基础功能：图片上传、生成图片链接</p> <p>附加功能：限制上传图片的大小与类型、生成高中低三种分辨率的图片链接、生成 CDN</p> <h3 id="代码实现"><a href="#代码实现" class="header-anchor">#</a> 代码实现</h3> <p>安装</p> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-body
npm i koa-static
</code></pre></div><p><strong>app.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>const KoaBody = require(&quot;koa-body&quot;);
const serve = require(&quot;koa-static&quot;);

// 静态资源目录
app.use(serve(path.join(__dirname, &quot;public&quot;)));
// 解析 body
app.use(
  KoaBody({
    multipart: true,
    formidable: {
      uploadDir: path.join(__dirname, &quot;public/uploads&quot;),
      keepExtensions: true,
    },
  })
);
</code></pre></div><p><strong>controllers/common.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>// Content-Type 为 multipart/form-data 才会被解析
upload(ctx) {
  const file = ctx.request.files.file;
  const basename = path.basename(file.path);
  ctx.body = {
    url: `${ctx.origin}/uploads/${basename}`,
  };
}
</code></pre></div><p><strong>public/index.html</strong></p> <div class="language- extra-class"><pre class="language-text"><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;title&gt;Document&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;form action=&quot;/upload&quot; enctype=&quot;multipart/form-data&quot; method=&quot;POST&quot;&gt;
      &lt;!-- 必须指定 name 否则后端获取不到文件 --&gt;
      &lt;input type=&quot;file&quot; name=&quot;file&quot; accept=&quot;image/*&quot; /&gt;
      &lt;button type=&quot;submit&quot;&gt;上传&lt;/button&gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre></div><p><code>accept</code>可以指定允许上传的图片类型，比如<code>image/gif, image/jpeg</code>，多种类型用逗号隔开</p> <h2 id="分页和模糊搜索"><a href="#分页和模糊搜索" class="header-anchor">#</a> 分页和模糊搜索</h2> <p><strong>controllers/questions.js</strong></p> <div class="language- extra-class"><pre class="language-text"><code>async find(ctx) {
  const { per_page = 10 } = ctx.query;
  const page = Math.max(ctx.query.page * 1, 1) - 1;
  const perPage = Math.max(per_page * 1, 1);
  const q = new RegExp(ctx.query.q);
  ctx.body = await Question.find({ $or: [{ title: q }, { description: q }] })
    .limit(perPage)
    .skip(perPage * page);
}
</code></pre></div><p>分页搜索的关键是<code>skip</code>和<code>limit</code>这两个查询参数，模糊搜索则使用了正则表达式</p> <h2 id="功能列表"><a href="#功能列表" class="header-anchor">#</a> 功能列表</h2> <h3 id="用户"><a href="#用户" class="header-anchor">#</a> 用户</h3> <ul><li>用户列表</li> <li>用户详情</li> <li>创建用户</li> <li>更新用户</li> <li>删除用户</li> <li>登录</li> <li>获取已关注用户列表</li> <li>获取用户粉丝列表</li> <li>关注用户</li> <li>取消关注</li> <li>用户关注话题列表</li> <li>用户关注话题</li> <li>用户取消关注话题</li> <li>用户关注问题列表</li> <li>用户问题列表(用户-问题的一对多关系)</li> <li>用户关注问题</li> <li>用户取消关注问题</li> <li>用户赞同答案列表</li> <li>用户赞同答案</li> <li>用户取消赞同</li> <li>用户不赞同答案列表</li> <li>用户不赞同答案</li> <li>用户取消不赞同</li> <li>用户收藏答案列表</li> <li>用户收藏答案</li> <li>用户取消收藏</li></ul> <h3 id="话题"><a href="#话题" class="header-anchor">#</a> 话题</h3> <ul><li>获取话题列表</li> <li>话题详情</li> <li>创建话题</li> <li>修改话题</li> <li>删除话题</li> <li>获取话题粉丝列表</li> <li>获取话题的问题列表</li></ul> <h3 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h3> <ul><li><p>问题列表</p></li> <li><p>创建问题</p></li> <li><p>修改问题</p></li> <li><p>删除问题</p></li> <li><p>问题详情</p></li> <li><p>问题的话题列表(问题-话题多对多关系)</p></li> <li><p>问题的关注列表(问题-用户多对多关系)</p></li></ul> <h3 id="回答"><a href="#回答" class="header-anchor">#</a> 回答</h3> <ul><li>回答列表</li> <li>创建回答(问题-答案/用户-答案一对多)</li> <li>回答详情</li> <li>修改回答</li> <li>删除回答</li></ul> <h3 id="评论"><a href="#评论" class="header-anchor">#</a> 评论</h3> <ul><li>获取评论列表</li> <li>发表评论(答案-评论/问题-评论/用户-评论一对多、多级评论)</li> <li>获取评论详情</li> <li>修改评论</li> <li>删除评论</li></ul> <h2 id="api-文档"><a href="#api-文档" class="header-anchor">#</a> API 文档</h2> <h3 id="登录"><a href="#登录" class="header-anchor">#</a> 登录</h3> <h4 id="接口"><a href="#接口" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>POST /users/login
</code></pre></div><h4 id="参数"><a href="#参数" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>name</td> <td>string</td> <td>body</td> <td>用户名，必填</td></tr> <tr><td>password</td> <td>string</td> <td>body</td> <td>密码，必填</td></tr></tbody></table> <h4 id="响应"><a href="#响应" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZjcxZDNkNDk4ZDRkYzBkZTEzMjAwZjUiLCJuYW1lIjoiYWxmYWxmYXciLCJpYXQiOjE2MDE0NjExNTMsImV4cCI6MTYwMTU0NzU1M30.HairtegFaKmtiFOyIZ7iWche11L8dlZ614bjynRhOWs&quot;
}
</code></pre></div><h3 id="获取用户列表"><a href="#获取用户列表" class="header-anchor">#</a> 获取用户列表</h3> <h4 id="接口-2"><a href="#接口-2" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users
</code></pre></div><h4 id="参数-2"><a href="#参数-2" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>per_page</td> <td>number</td> <td>query</td> <td>可选，每页大小</td></tr> <tr><td>page</td> <td>number</td> <td>query</td> <td>可选，当前所在页码</td></tr></tbody></table> <h4 id="响应-2"><a href="#响应-2" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;gender&quot;: &quot;male&quot;,
    &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;name&quot;: &quot;alfalfaw&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 3
  }
]
</code></pre></div><h3 id="获取用户详情"><a href="#获取用户详情" class="header-anchor">#</a> 获取用户详情</h3> <h4 id="接口-3"><a href="#接口-3" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id
</code></pre></div><h4 id="参数-3"><a href="#参数-3" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，用户 id</td></tr> <tr><td>fields</td> <td>string</td> <td>query</td> <td>可选，需要增加到返回结果中的字段。可选项<code>locations business employments educations following followingTopics likingAnswers dislikingAnswers collectingAnswers</code></td></tr></tbody></table> <h4 id="响应-3"><a href="#响应-3" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;gender&quot;: &quot;male&quot;,
  &quot;locations&quot;: [],
  &quot;following&quot;: [],
  &quot;followingTopics&quot;: [
    {
      &quot;_id&quot;: &quot;5f71ddf84557410e40278a2e&quot;,
      &quot;name&quot;: &quot;水木年华&quot;,
      &quot;avatar_url&quot;: &quot;test_url&quot;,
      &quot;__v&quot;: 0
    }
  ],
  &quot;likingAnswers&quot;: [
    {
      &quot;voteCount&quot;: 0,
      &quot;_id&quot;: &quot;5f771b1b1755574dbb6f5b0b&quot;,
      &quot;content&quot;: &quot;这是答案&quot;,
      &quot;answerer&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
      &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
      &quot;createdAt&quot;: &quot;2020-10-02T12:20:43.530Z&quot;,
      &quot;updatedAt&quot;: &quot;2020-10-02T12:30:28.505Z&quot;,
      &quot;__v&quot;: 0
    }
  ],
  &quot;dislikingAnswers&quot;: [],
  &quot;collectingAnswers&quot;: [],
  &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
  &quot;name&quot;: &quot;alfalfaw&quot;,
  &quot;avatar_url&quot;: &quot;test_url&quot;,
  &quot;__v&quot;: 10,
  &quot;updatedAt&quot;: &quot;2020-10-02T13:00:53.472Z&quot;,
  &quot;createdAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;
}
</code></pre></div><h3 id="创建用户"><a href="#创建用户" class="header-anchor">#</a> 创建用户</h3> <h4 id="接口-4"><a href="#接口-4" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>POST /users
</code></pre></div><h4 id="参数-4"><a href="#参数-4" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>name</td> <td>string</td> <td>body</td> <td>必须且唯一，用户名</td></tr> <tr><td>password</td> <td>string</td> <td>body</td> <td>必须，用户密码</td></tr></tbody></table> <h4 id="响应-4"><a href="#响应-4" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;gender&quot;: &quot;male&quot;,
  &quot;locations&quot;: [],
  &quot;following&quot;: [],
  &quot;followingTopics&quot;: [],
  &quot;likingAnswers&quot;: [],
  &quot;dislikingAnswers&quot;: [],
  &quot;collectingAnswers&quot;: [],
  &quot;_id&quot;: &quot;5f76d22e58edc146378be327&quot;,
  &quot;name&quot;: &quot;alfalfaw2&quot;,
  &quot;password&quot;: &quot;$2b$10$jNfWo9MYKKJs9N4xUzv9WeumlSProJxQ7L5TBMDPBrQ9VjJXm1ZD.&quot;,
  &quot;employments&quot;: [],
  &quot;educations&quot;: [],
  &quot;createdAt&quot;: &quot;2020-10-02T07:09:35.017Z&quot;,
  &quot;updatedAt&quot;: &quot;2020-10-02T07:09:35.017Z&quot;,
  &quot;__v&quot;: 0
}
</code></pre></div><h3 id="修改用户资料"><a href="#修改用户资料" class="header-anchor">#</a> 修改用户资料</h3> <h4 id="接口-5"><a href="#接口-5" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PATCH /users
</code></pre></div><h4 id="参数-5"><a href="#参数-5" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必须，token 参数</td></tr> <tr><td>name</td> <td>string</td> <td>body</td> <td>可选，用户名</td></tr> <tr><td>password</td> <td>string</td> <td>body</td> <td>可选，密码</td></tr> <tr><td>avatar_url</td> <td>string</td> <td>body</td> <td>可选，头像</td></tr> <tr><td>gender</td> <td>enum</td> <td>body</td> <td>可选，性别。'male'或者'female'</td></tr> <tr><td>headline</td> <td>string</td> <td>body</td> <td>可选，简介</td></tr> <tr><td>locations</td> <td>array</td> <td>body</td> <td>可选，地点</td></tr> <tr><td>business</td> <td>object</td> <td>body</td> <td>可选，行业</td></tr> <tr><td>employments</td> <td>array</td> <td>body</td> <td>可选，职业经历</td></tr> <tr><td>educations</td> <td>array</td> <td>body</td> <td>可选，教育经历</td></tr> <tr><td>following</td> <td>array</td> <td>body</td> <td>可选，关注的人</td></tr> <tr><td>followingTopics</td> <td>array</td> <td>body</td> <td>可选，关注的话题</td></tr> <tr><td>likingAnswers</td> <td>array</td> <td>body</td> <td>可选，喜欢的答案</td></tr> <tr><td>dislikingAnswers</td> <td>array</td> <td>body</td> <td>可选，不喜欢的答案</td></tr> <tr><td>collectingAnswers</td> <td>array</td> <td>body</td> <td>可选，收藏的答案</td></tr></tbody></table> <h4 id="响应-5"><a href="#响应-5" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;gender&quot;: &quot;male&quot;,
  &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
  &quot;name&quot;: &quot;alfalfaw&quot;,
  &quot;avatar_url&quot;: &quot;test_url&quot;,
  &quot;__v&quot;: 10,
  &quot;updatedAt&quot;: &quot;2020-10-02T13:05:26.961Z&quot;,
  &quot;createdAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;
}
</code></pre></div><h3 id="删除用户"><a href="#删除用户" class="header-anchor">#</a> 删除用户</h3> <h4 id="接口-6"><a href="#接口-6" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /users
</code></pre></div><h4 id="参数-6"><a href="#参数-6" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必须，token 参数</td></tr></tbody></table> <h4 id="响应-6"><a href="#响应-6" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="获取已关注用户列表"><a href="#获取已关注用户列表" class="header-anchor">#</a> 获取已关注用户列表</h3> <h4 id="接口-7"><a href="#接口-7" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id/following
</code></pre></div><h4 id="参数-7"><a href="#参数-7" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，用户 id</td></tr></tbody></table> <h4 id="响应-7"><a href="#响应-7" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;gender&quot;: &quot;male&quot;,
    &quot;_id&quot;: &quot;5f7705281d073d487d312571&quot;,
    &quot;name&quot;: &quot;tom&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T10:47:04.147Z&quot;,
    &quot;updatedAt&quot;: &quot;2020-10-02T10:47:04.147Z&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="关注用户"><a href="#关注用户" class="header-anchor">#</a> 关注用户</h3> <h4 id="接口-8"><a href="#接口-8" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PUT /users/following/:id
</code></pre></div><h4 id="参数-8"><a href="#参数-8" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必须，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必须，被关注人的 id</td></tr></tbody></table> <h4 id="响应-8"><a href="#响应-8" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="获取用户粉丝列表"><a href="#获取用户粉丝列表" class="header-anchor">#</a> 获取用户粉丝列表</h3> <h4 id="接口-9"><a href="#接口-9" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id/followers
</code></pre></div><h4 id="参数-9"><a href="#参数-9" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，用户 id</td></tr></tbody></table> <h4 id="响应-9"><a href="#响应-9" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;gender&quot;: &quot;male&quot;,
    &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;name&quot;: &quot;alfalfaw&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 4,
    &quot;updatedAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;
  }
]
</code></pre></div><h3 id="取消关注用户"><a href="#取消关注用户" class="header-anchor">#</a> 取消关注用户</h3> <h4 id="接口-10"><a href="#接口-10" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /users/following/:id
</code></pre></div><h4 id="参数-10"><a href="#参数-10" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，取消关注的用户 id</td></tr></tbody></table> <h4 id="响应-10"><a href="#响应-10" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="获取用户关注话题列表"><a href="#获取用户关注话题列表" class="header-anchor">#</a> 获取用户关注话题列表</h3> <h4 id="接口-11"><a href="#接口-11" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id/followingTopics
</code></pre></div><h4 id="参数-11"><a href="#参数-11" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，用户 id</td></tr></tbody></table> <h4 id="响应-11"><a href="#响应-11" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;_id&quot;: &quot;5f71ddf84557410e40278a2e&quot;,
    &quot;name&quot;: &quot;水木年华&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="用户关注话题"><a href="#用户关注话题" class="header-anchor">#</a> 用户关注话题</h3> <h4 id="接口-12"><a href="#接口-12" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PUT /users/followingTopic/:id
</code></pre></div><h4 id="参数-12"><a href="#参数-12" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，话题 id</td></tr></tbody></table> <h4 id="响应-12"><a href="#响应-12" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="用户取消关注话题"><a href="#用户取消关注话题" class="header-anchor">#</a> 用户取消关注话题</h3> <h4 id="接口-13"><a href="#接口-13" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /users/followingTopic/:id
</code></pre></div><h4 id="参数-13"><a href="#参数-13" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，话题 id</td></tr></tbody></table> <h4 id="响应-13"><a href="#响应-13" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="获取用户问题列表"><a href="#获取用户问题列表" class="header-anchor">#</a> 获取用户问题列表</h3> <h4 id="接口-14"><a href="#接口-14" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id/questions
</code></pre></div><h4 id="参数-14"><a href="#参数-14" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，用户 id</td></tr></tbody></table> <h4 id="响应-14"><a href="#响应-14" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;_id&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;title&quot;: &quot;如何看待鸿蒙应用开发框架采用JavaScript作为开发语言？&quot;,
    &quot;description&quot;: &quot;&quot;,
    &quot;questioner&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="用户喜欢的答案列表"><a href="#用户喜欢的答案列表" class="header-anchor">#</a> 用户喜欢的答案列表</h3> <h4 id="接口-15"><a href="#接口-15" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id/likingAnswers
</code></pre></div><h4 id="参数-15"><a href="#参数-15" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，答案 id</td></tr></tbody></table> <h4 id="响应-15"><a href="#响应-15" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;voteCount&quot;: 1,
    &quot;_id&quot;: &quot;5f771b1b1755574dbb6f5b0b&quot;,
    &quot;content&quot;: &quot;这是回答&quot;,
    &quot;answerer&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T12:20:43.530Z&quot;,
    &quot;updatedAt&quot;: &quot;2020-10-02T12:21:19.528Z&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="用户喜欢答案"><a href="#用户喜欢答案" class="header-anchor">#</a> 用户喜欢答案</h3> <h4 id="接口-16"><a href="#接口-16" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PUT /users/likingAnswers/:id
</code></pre></div><h4 id="参数-16"><a href="#参数-16" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，答案 id</td></tr></tbody></table> <h4 id="响应-16"><a href="#响应-16" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="用户取消喜欢答案"><a href="#用户取消喜欢答案" class="header-anchor">#</a> 用户取消喜欢答案</h3> <h4 id="接口-17"><a href="#接口-17" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /users/likingAnswers/:id
</code></pre></div><h4 id="参数-17"><a href="#参数-17" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，答案 id</td></tr></tbody></table> <h4 id="响应-17"><a href="#响应-17" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="用户不喜欢的答案列表"><a href="#用户不喜欢的答案列表" class="header-anchor">#</a> 用户不喜欢的答案列表</h3> <h4 id="接口-18"><a href="#接口-18" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id/dislikingAnswers
</code></pre></div><h4 id="参数-18"><a href="#参数-18" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，用户 id</td></tr></tbody></table> <h4 id="响应-18"><a href="#响应-18" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;voteCount&quot;: 0,
    &quot;_id&quot;: &quot;5f771b1b1755574dbb6f5b0b&quot;,
    &quot;content&quot;: &quot;这是回答&quot;,
    &quot;answerer&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T12:20:43.530Z&quot;,
    &quot;updatedAt&quot;: &quot;2020-10-02T12:30:28.505Z&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="用户不喜欢答案"><a href="#用户不喜欢答案" class="header-anchor">#</a> 用户不喜欢答案</h3> <h4 id="接口-19"><a href="#接口-19" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PUT /users/dislikingAnswers/:id
</code></pre></div><h4 id="参数-19"><a href="#参数-19" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，答案 id</td></tr></tbody></table> <h4 id="响应-19"><a href="#响应-19" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="用户取消不喜欢回答"><a href="#用户取消不喜欢回答" class="header-anchor">#</a> 用户取消不喜欢回答</h3> <h4 id="接口-20"><a href="#接口-20" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /users/dislikingAnswers/:id
</code></pre></div><h4 id="参数-20"><a href="#参数-20" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，回答 id</td></tr></tbody></table> <h4 id="响应-20"><a href="#响应-20" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="用户收藏答案列表"><a href="#用户收藏答案列表" class="header-anchor">#</a> 用户收藏答案列表</h3> <h4 id="接口-21"><a href="#接口-21" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id/collectingAnswers
</code></pre></div><h4 id="参数-21"><a href="#参数-21" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，用户 id</td></tr></tbody></table> <h4 id="响应-21"><a href="#响应-21" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;voteCount&quot;: 0,
    &quot;_id&quot;: &quot;5f771b1b1755574dbb6f5b0b&quot;,
    &quot;content&quot;: &quot;这是回答&quot;,
    &quot;answerer&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T12:20:43.530Z&quot;,
    &quot;updatedAt&quot;: &quot;2020-10-02T12:30:28.505Z&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="用户收藏答案"><a href="#用户收藏答案" class="header-anchor">#</a> 用户收藏答案</h3> <h4 id="接口-22"><a href="#接口-22" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PUT /users/collectingAnswers/:id
</code></pre></div><h4 id="参数-22"><a href="#参数-22" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，答案 id</td></tr></tbody></table> <h4 id="响应-22"><a href="#响应-22" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="用户取消收藏答案"><a href="#用户取消收藏答案" class="header-anchor">#</a> 用户取消收藏答案</h3> <h4 id="接口-23"><a href="#接口-23" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /users/collectingAnswers/:id
</code></pre></div><h4 id="参数-23"><a href="#参数-23" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，答案 id</td></tr></tbody></table> <h4 id="响应-23"><a href="#响应-23" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="创建回答"><a href="#创建回答" class="header-anchor">#</a> 创建回答</h3> <h4 id="接口-24"><a href="#接口-24" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>POST /questions/:questionId/answers
</code></pre></div><h4 id="参数-24"><a href="#参数-24" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr></tbody></table> <h4 id="响应-24"><a href="#响应-24" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;topics&quot;: [],
  &quot;voteCount&quot;: 0,
  &quot;_id&quot;: &quot;5f77177b90d3df4c46def772&quot;,
  &quot;content&quot;: &quot;这是回答&quot;,
  &quot;answerer&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
  &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
  &quot;createdAt&quot;: &quot;2020-10-02T12:05:15.146Z&quot;,
  &quot;updatedAt&quot;: &quot;2020-10-02T12:05:15.146Z&quot;,
  &quot;__v&quot;: 0
}
</code></pre></div><h3 id="获取回答列表"><a href="#获取回答列表" class="header-anchor">#</a> 获取回答列表</h3> <h4 id="接口-25"><a href="#接口-25" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /questions/:questionId/answers
</code></pre></div><h4 id="参数-25"><a href="#参数-25" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr></tbody></table> <h4 id="响应-25"><a href="#响应-25" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;voteCount&quot;: 0,
    &quot;_id&quot;: &quot;5f77177b90d3df4c46def772&quot;,
    &quot;content&quot;: &quot;这是回答&quot;,
    &quot;answerer&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T12:05:15.146Z&quot;,
    &quot;updatedAt&quot;: &quot;2020-10-02T12:05:15.146Z&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="获取回答详情"><a href="#获取回答详情" class="header-anchor">#</a> 获取回答详情</h3> <h4 id="接口-26"><a href="#接口-26" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /questions/:questionId/answers/:id
</code></pre></div><h4 id="参数-26"><a href="#参数-26" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，答案 id</td></tr></tbody></table> <h4 id="响应-26"><a href="#响应-26" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;voteCount&quot;: 0,
  &quot;_id&quot;: &quot;5f77177b90d3df4c46def772&quot;,
  &quot;content&quot;: &quot;这是答案&quot;,
  &quot;answerer&quot;: {
    &quot;gender&quot;: &quot;male&quot;,
    &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;name&quot;: &quot;alfalfaw&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 10,
    &quot;updatedAt&quot;: &quot;2020-10-02T13:05:26.961Z&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;
  },
  &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
  &quot;createdAt&quot;: &quot;2020-10-02T12:05:15.146Z&quot;,
  &quot;updatedAt&quot;: &quot;2020-10-02T12:05:15.146Z&quot;,
  &quot;__v&quot;: 0
}
</code></pre></div><h3 id="修改回答"><a href="#修改回答" class="header-anchor">#</a> 修改回答</h3> <h4 id="接口-27"><a href="#接口-27" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PATCH /questions/:questionId/answers/:id
</code></pre></div><h4 id="参数-27"><a href="#参数-27" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，答案 id</td></tr></tbody></table> <h4 id="响应-27"><a href="#响应-27" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;n&quot;: 1,
  &quot;nModified&quot;: 1,
  &quot;ok&quot;: 1
}
</code></pre></div><h3 id="删除回答"><a href="#删除回答" class="header-anchor">#</a> 删除回答</h3> <h4 id="接口-28"><a href="#接口-28" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /questions/:questionId/answers/:id
</code></pre></div><h4 id="参数-28"><a href="#参数-28" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，答案 id</td></tr></tbody></table> <h4 id="响应-28"><a href="#响应-28" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="获取问题列表"><a href="#获取问题列表" class="header-anchor">#</a> 获取问题列表</h3> <h4 id="接口-29"><a href="#接口-29" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /questions
</code></pre></div><h4 id="参数-29"><a href="#参数-29" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>per_page</td> <td>number</td> <td>query</td> <td>可选，每页大小</td></tr> <tr><td>page</td> <td>number</td> <td>query</td> <td>可选，当前所在页码</td></tr></tbody></table> <h4 id="响应-29"><a href="#响应-29" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;_id&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;title&quot;: &quot;这是一个问题&quot;,
    &quot;description&quot;: &quot;这是问题的描述&quot;,
    &quot;questioner&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="获取问题详情"><a href="#获取问题详情" class="header-anchor">#</a> 获取问题详情</h3> <h4 id="接口-30"><a href="#接口-30" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /questions/:id
</code></pre></div><h4 id="参数-30"><a href="#参数-30" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr></tbody></table> <h4 id="响应-30"><a href="#响应-30" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;topics&quot;: [],
  &quot;_id&quot;: &quot;5f734af88519d353e0dcea03&quot;,
  &quot;title&quot;: &quot;这是一个问题&quot;,
  &quot;description&quot;: &quot;这是问题的描述&quot;,
  &quot;questioner&quot;: {
    &quot;gender&quot;: &quot;male&quot;,
    &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;name&quot;: &quot;alfalfaw&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 10,
    &quot;updatedAt&quot;: &quot;2020-10-02T13:05:26.961Z&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;
  },
  &quot;__v&quot;: 0
}
</code></pre></div><h3 id="创建问题"><a href="#创建问题" class="header-anchor">#</a> 创建问题</h3> <h4 id="接口-31"><a href="#接口-31" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>POST /questions
</code></pre></div><h4 id="参数-31"><a href="#参数-31" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>title</td> <td>string</td> <td>body</td> <td>必选，标题</td></tr> <tr><td>description</td> <td>string</td> <td>body</td> <td>可选，问题描述</td></tr></tbody></table> <h4 id="响应-31"><a href="#响应-31" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;topics&quot;: [],
  &quot;_id&quot;: &quot;5f7730043312fc52b064db4c&quot;,
  &quot;title&quot;: &quot;问题1&quot;,
  &quot;description&quot;: &quot;描述1&quot;,
  &quot;questioner&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
  &quot;createdAt&quot;: &quot;2020-10-02T13:49:56.776Z&quot;,
  &quot;updatedAt&quot;: &quot;2020-10-02T13:49:56.776Z&quot;,
  &quot;__v&quot;: 0
}
</code></pre></div><h3 id="修改问题"><a href="#修改问题" class="header-anchor">#</a> 修改问题</h3> <h4 id="接口-32"><a href="#接口-32" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PATCH /questions/:id
</code></pre></div><h4 id="参数-32"><a href="#参数-32" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr></tbody></table> <h4 id="响应-32"><a href="#响应-32" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{ &quot;n&quot;: 1, &quot;nModified&quot;: 1, &quot;ok&quot;: 1 }
</code></pre></div><h3 id="删除问题"><a href="#删除问题" class="header-anchor">#</a> 删除问题</h3> <h4 id="接口-33"><a href="#接口-33" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /questions/:id
</code></pre></div><h4 id="参数-33"><a href="#参数-33" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr></tbody></table> <h4 id="响应-33"><a href="#响应-33" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="获取问题的关注列表"><a href="#获取问题的关注列表" class="header-anchor">#</a> 获取问题的关注列表</h3> <h4 id="接口-34"><a href="#接口-34" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /questions/:id/followers
</code></pre></div><h4 id="参数-34"><a href="#参数-34" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>问题 id</td></tr></tbody></table> <h4 id="响应-34"><a href="#响应-34" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;gender&quot;: &quot;male&quot;,
    &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;name&quot;: &quot;alfalfaw&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 11,
    &quot;updatedAt&quot;: &quot;2020-10-02T14:33:05.207Z&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;
  }
]
</code></pre></div><h3 id="获取用户问题列表-2"><a href="#获取用户问题列表-2" class="header-anchor">#</a> 获取用户问题列表</h3> <h4 id="接口-35"><a href="#接口-35" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id/questions
</code></pre></div><h4 id="参数-35"><a href="#参数-35" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>用户 id</td></tr></tbody></table> <h4 id="响应-35"><a href="#响应-35" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;_id&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;title&quot;: &quot;问题122s&quot;,
    &quot;description&quot;: &quot;描述1&quot;,
    &quot;questioner&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;__v&quot;: 0,
    &quot;updatedAt&quot;: &quot;2020-10-02T14:06:18.276Z&quot;
  },
  {
    &quot;_id&quot;: &quot;5f7730043312fc52b064db4c&quot;,
    &quot;title&quot;: &quot;问题1&quot;,
    &quot;description&quot;: &quot;描述1&quot;,
    &quot;questioner&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T13:49:56.776Z&quot;,
    &quot;updatedAt&quot;: &quot;2020-10-02T13:49:56.776Z&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="获取用户关注问题列表"><a href="#获取用户关注问题列表" class="header-anchor">#</a> 获取用户关注问题列表</h3> <h4 id="接口-36"><a href="#接口-36" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /users/:id/followingQuestions
</code></pre></div><h4 id="参数-36"><a href="#参数-36" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，用户 id</td></tr></tbody></table> <h4 id="响应-36"><a href="#响应-36" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;_id&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;title&quot;: &quot;问题122s&quot;,
    &quot;description&quot;: &quot;描述1&quot;,
    &quot;questioner&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;__v&quot;: 0,
    &quot;updatedAt&quot;: &quot;2020-10-02T14:06:18.276Z&quot;
  }
]
</code></pre></div><h3 id="用户关注问题"><a href="#用户关注问题" class="header-anchor">#</a> 用户关注问题</h3> <h4 id="接口-37"><a href="#接口-37" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PUT /users/followingQuestion/:id
</code></pre></div><h4 id="参数-37"><a href="#参数-37" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr></tbody></table> <h4 id="响应-37"><a href="#响应-37" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="用户取消关注问题"><a href="#用户取消关注问题" class="header-anchor">#</a> 用户取消关注问题</h3> <h4 id="接口-38"><a href="#接口-38" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /users/followingQuestion/:id
</code></pre></div><h4 id="参数-38"><a href="#参数-38" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr></tbody></table> <h4 id="响应-38"><a href="#响应-38" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="获取问题的话题列表"><a href="#获取问题的话题列表" class="header-anchor">#</a> 获取问题的话题列表</h3> <h4 id="接口-39"><a href="#接口-39" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /questions/:id/topics
</code></pre></div><h4 id="参数-39"><a href="#参数-39" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr></tbody></table> <h4 id="响应-39"><a href="#响应-39" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;_id&quot;: &quot;5f71ddf84557410e40278a2e&quot;,
    &quot;name&quot;: &quot;水木年华&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="获取话题列表"><a href="#获取话题列表" class="header-anchor">#</a> 获取话题列表</h3> <h4 id="接口-40"><a href="#接口-40" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /topics
</code></pre></div><h4 id="参数-40"><a href="#参数-40" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>per_page</td> <td>number</td> <td>query</td> <td>可选，每页大小</td></tr> <tr><td>page</td> <td>number</td> <td>query</td> <td>可选，当前所在页码</td></tr></tbody></table> <h4 id="响应-40"><a href="#响应-40" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;_id&quot;: &quot;5f71ddf84557410e40278a2e&quot;,
    &quot;name&quot;: &quot;水木年华&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="获取话题详情"><a href="#获取话题详情" class="header-anchor">#</a> 获取话题详情</h3> <h4 id="接口-41"><a href="#接口-41" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /topics/:id
</code></pre></div><h4 id="参数-41"><a href="#参数-41" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>必选，话题 id</td></tr></tbody></table> <h4 id="响应-41"><a href="#响应-41" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;_id&quot;: &quot;5f71ddf84557410e40278a2e&quot;,
  &quot;name&quot;: &quot;水木年华&quot;,
  &quot;avatar_url&quot;: &quot;test_url&quot;,
  &quot;__v&quot;: 0
}
</code></pre></div><h3 id="创建话题"><a href="#创建话题" class="header-anchor">#</a> 创建话题</h3> <h4 id="接口-42"><a href="#接口-42" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>POST /topics
</code></pre></div><h4 id="参数-42"><a href="#参数-42" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>name</td> <td>string</td> <td>body</td> <td>必选，标题</td></tr> <tr><td>avatar_url</td> <td>string</td> <td>body</td> <td>可选，话题封面</td></tr> <tr><td>introduction</td> <td>string</td> <td>body</td> <td>可选，话题描述</td></tr></tbody></table> <h4 id="响应-42"><a href="#响应-42" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;_id&quot;: &quot;5f77402928281f57f19bb665&quot;,
  &quot;name&quot;: &quot;水木年华11&quot;,
  &quot;avatar_url&quot;: &quot;test_url&quot;,
  &quot;introduction&quot;: &quot;测试话题&quot;,
  &quot;createdAt&quot;: &quot;2020-10-02T14:58:49.727Z&quot;,
  &quot;updatedAt&quot;: &quot;2020-10-02T14:58:49.727Z&quot;,
  &quot;__v&quot;: 0
}
</code></pre></div><h3 id="删除话题"><a href="#删除话题" class="header-anchor">#</a> 删除话题</h3> <h4 id="接口-43"><a href="#接口-43" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /topics/:id
</code></pre></div><h4 id="参数-43"><a href="#参数-43" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>话题 id</td></tr></tbody></table> <h4 id="响应-43"><a href="#响应-43" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="获取话题粉丝列表"><a href="#获取话题粉丝列表" class="header-anchor">#</a> 获取话题粉丝列表</h3> <h4 id="接口-44"><a href="#接口-44" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /topics/:id/followers
</code></pre></div><h4 id="参数-44"><a href="#参数-44" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>话题 id</td></tr></tbody></table> <h4 id="响应-44"><a href="#响应-44" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;gender&quot;: &quot;male&quot;,
    &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;name&quot;: &quot;alfalfaw&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 11,
    &quot;updatedAt&quot;: &quot;2020-10-02T14:33:05.207Z&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;
  }
]
</code></pre></div><h3 id="获取话题的问题列表"><a href="#获取话题的问题列表" class="header-anchor">#</a> 获取话题的问题列表</h3> <h4 id="接口-45"><a href="#接口-45" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /topics/:id/questions
</code></pre></div><h4 id="参数-45"><a href="#参数-45" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>id</td> <td>string</td> <td>path</td> <td>话题 id</td></tr></tbody></table> <h4 id="响应-45"><a href="#响应-45" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;_id&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;title&quot;: &quot;问题122s&quot;,
    &quot;description&quot;: &quot;描述1&quot;,
    &quot;questioner&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;__v&quot;: 0,
    &quot;updatedAt&quot;: &quot;2020-10-02T15:13:42.624Z&quot;
  }
]
</code></pre></div><h3 id="获取评论列表"><a href="#获取评论列表" class="header-anchor">#</a> 获取评论列表</h3> <h4 id="接口-46"><a href="#接口-46" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /questions/:questionId/answers/:answerId/comments
</code></pre></div><h4 id="参数-46"><a href="#参数-46" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr> <tr><td>answerId</td> <td>string</td> <td>path</td> <td>必选，回答 id</td></tr></tbody></table> <h4 id="响应-46"><a href="#响应-46" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>[
  {
    &quot;_id&quot;: &quot;5f7749065aabfe5ac4d5c4d0&quot;,
    &quot;content&quot;: &quot;评论1&quot;,
    &quot;commentator&quot;: {
      &quot;gender&quot;: &quot;male&quot;,
      &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
      &quot;name&quot;: &quot;alfalfaw&quot;,
      &quot;avatar_url&quot;: &quot;test_url&quot;,
      &quot;__v&quot;: 11,
      &quot;updatedAt&quot;: &quot;2020-10-02T14:33:05.207Z&quot;,
      &quot;createdAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;
    },
    &quot;answerId&quot;: &quot;5f771b1b1755574dbb6f5b0b&quot;,
    &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T15:36:38.362Z&quot;,
    &quot;updatedAt&quot;: &quot;2020-10-02T15:36:38.362Z&quot;,
    &quot;__v&quot;: 0
  }
]
</code></pre></div><h3 id="发表评论"><a href="#发表评论" class="header-anchor">#</a> 发表评论</h3> <h4 id="接口-47"><a href="#接口-47" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>POST /questions/:questionId/answers/:answerId/comments
</code></pre></div><h4 id="参数-47"><a href="#参数-47" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr> <tr><td>answerId</td> <td>string</td> <td>path</td> <td>必选，回答 id</td></tr> <tr><td>content</td> <td>string</td> <td>body</td> <td>必选，评论内容</td></tr> <tr><td>parentId</td> <td>string</td> <td>body</td> <td>可选，父评论 id</td></tr> <tr><td>replyTo</td> <td>string</td> <td>body</td> <td>可选，被评论的人</td></tr></tbody></table> <h4 id="响应-47"><a href="#响应-47" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;_id&quot;: &quot;5f7749065aabfe5ac4d5c4d0&quot;,
  &quot;content&quot;: &quot;评论1&quot;,
  &quot;commentator&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
  &quot;answerId&quot;: &quot;5f771b1b1755574dbb6f5b0b&quot;,
  &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
  &quot;createdAt&quot;: &quot;2020-10-02T15:36:38.362Z&quot;,
  &quot;updatedAt&quot;: &quot;2020-10-02T15:36:38.362Z&quot;,
  &quot;__v&quot;: 0
}
</code></pre></div><h3 id="获取评论详情"><a href="#获取评论详情" class="header-anchor">#</a> 获取评论详情</h3> <h4 id="接口-48"><a href="#接口-48" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>GET /questions/:questionId/answers/:answerId/comments/:id
</code></pre></div><h4 id="参数-48"><a href="#参数-48" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr> <tr><td>answerId</td> <td>string</td> <td>path</td> <td>必选，回答 id</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，评论 id</td></tr></tbody></table> <h4 id="响应-48"><a href="#响应-48" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;_id&quot;: &quot;5f7749065aabfe5ac4d5c4d0&quot;,
  &quot;content&quot;: &quot;评论1&quot;,
  &quot;commentator&quot;: {
    &quot;gender&quot;: &quot;male&quot;,
    &quot;_id&quot;: &quot;5f71d3d498d4dc0de13200f5&quot;,
    &quot;name&quot;: &quot;alfalfaw&quot;,
    &quot;avatar_url&quot;: &quot;test_url&quot;,
    &quot;__v&quot;: 11,
    &quot;updatedAt&quot;: &quot;2020-10-02T14:33:05.207Z&quot;,
    &quot;createdAt&quot;: &quot;2020-10-02T10:52:46.202Z&quot;
  },
  &quot;answerId&quot;: &quot;5f771b1b1755574dbb6f5b0b&quot;,
  &quot;questionId&quot;: &quot;5f734af88519d353e0dcea03&quot;,
  &quot;createdAt&quot;: &quot;2020-10-02T15:36:38.362Z&quot;,
  &quot;updatedAt&quot;: &quot;2020-10-02T15:36:38.362Z&quot;,
  &quot;__v&quot;: 0
}
</code></pre></div><h3 id="修改评论"><a href="#修改评论" class="header-anchor">#</a> 修改评论</h3> <h4 id="接口-49"><a href="#接口-49" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>PATCH /questions/:questionId/answers/:answerId/comments/:id
</code></pre></div><h4 id="参数-49"><a href="#参数-49" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr> <tr><td>answerId</td> <td>string</td> <td>path</td> <td>必选，回答 id</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，评论 id</td></tr> <tr><td>content</td> <td>string</td> <td>body</td> <td>必选，评论内容</td></tr></tbody></table> <h4 id="响应-49"><a href="#响应-49" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div><h3 id="删除评论"><a href="#删除评论" class="header-anchor">#</a> 删除评论</h3> <h4 id="接口-50"><a href="#接口-50" class="header-anchor">#</a> 接口：</h4> <div class="language- extra-class"><pre class="language-text"><code>DELETE /questions/:questionId/answers/:answerId/comments/:id
</code></pre></div><h4 id="参数-50"><a href="#参数-50" class="header-anchor">#</a> 参数：</h4> <table><thead><tr><th>参数名</th> <th>参数类型</th> <th>参数位置</th> <th>描述</th></tr></thead> <tbody><tr><td>Authorization</td> <td>string</td> <td>header</td> <td>必选，token 参数</td></tr> <tr><td>questionId</td> <td>string</td> <td>path</td> <td>必选，问题 id</td></tr> <tr><td>answerId</td> <td>string</td> <td>path</td> <td>必选，回答 id</td></tr> <tr><td>id</td> <td>string</td> <td>path</td> <td>必选，评论 id</td></tr></tbody></table> <h4 id="响应-50"><a href="#响应-50" class="header-anchor">#</a> 响应：</h4> <div class="language- extra-class"><pre class="language-text"><code>status 204
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/alfalfaw/frontend/edit/main/docs/blog/Koa学习笔记|Koa.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">12/11/2020, 5:29:08 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frontend/blog/Express学习笔记|Express.html" class="prev">
        Express 笔记
      </a></span> <span class="next"><a href="/frontend/blog/VuePress部署到GithubPages|前端.html">
        VuePress 搭建个人博客网站
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/frontend/assets/js/app.81e51045.js" defer></script><script src="/frontend/assets/js/2.b2951490.js" defer></script><script src="/frontend/assets/js/9.ba78b3d4.js" defer></script>
  </body>
</html>
